webpackJsonp([46],{EGlr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("BO1k"),i=a.n(r),s={name:"resourceApply",data:function(){return{loading:!1,newOrder:{},isApply:!0,activeName:"first",resourceList:[],multipleSelection:[],idList:[],curPage:0,isshow:!1,fileList:[],startDate:"",endDate:"",statusList:[{text:"草稿",value:"1"},{text:"已提交",value:"2"},{text:"待发布",value:"3"},{text:"发布中",value:"4"},{text:"成功",value:"5"},{text:"审核未通过",value:"6"}],resourced:"",status:[],total:0,title:"",sidx:"createTime",order:"desc",isSubmite:!1}},watch:{$route:"init"},components:{loadingTip:a("T8Lg").a},methods:{reset:function(){this.title="",this.startDate="",this.endDate="",this.getMyOrder()},updateTimeFormat:function(t,e,a,r){if(a)return a.split(" ")[0]},handleSelectionChange:function(t){this.multipleSelection=t,this.idList=[];var e=!0,a=!1,r=void 0;try{for(var s,n=i()(this.multipleSelection);!(e=(s=n.next()).done);e=!0){var l=s.value;this.idList.push(l.id)}}catch(t){a=!0,r=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw r}}},handleCurrentChange:function(t){this.curPage=t,this.getMyOrder()},godtl:function(t,e){this.$router.push({path:"/main/resourceApply/resourceOrderDetaile",query:{id:e.id,type:0}})},filterTag:function(t,e,a){return!0},filterStatus:function(t){this.status=t.status,this.getMyOrder()},tbformat:function(t,e,a,r){var s=!0,n=!1,l=void 0;try{for(var o,c=i()(this.statusList);!(s=(o=c.next()).done);s=!0){var d=o.value;if(d.value==a)return d.text}}catch(t){n=!0,l=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw l}}},addNew:function(){this.newOrder={},this.isshow=!0},editeOrder:function(){1==this.multipleSelection.length?this.$router.push({path:"/main/resourceApply/resourceOrderDetaile",query:{id:this.multipleSelection[0].id,type:1,editorPrice:0}}):this.$message({message:"请先选择一条数据！",type:"error"})},submitOrder:function(){if(0!=this.multipleSelection.length){var t=!0,e=!1,a=void 0;try{for(var r,s=i()(this.multipleSelection);!(t=(r=s.next()).done);t=!0){if(1!=r.value.status)return void this.$message.error("只能选择草稿状态的资源！")}}catch(t){e=!0,a=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw a}}var n=this;n.$http({method:"post",url:"/admin/cms/resourcelist/submit",data:n.idList,headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){0==t.data.code?(n.$message.success("提交成功！"),n.getMyOrder()):n.$message({type:"error",dangerouslyUseHTMLString:!0,message:t.data.msg})})}else this.$message.error("请选择一条数据")},addNewOrder:function(){var t=this;t.isSubmite=!0,t.$http({method:"post",url:"/admin/cms/resourcelist/save",data:t.newOrder,headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(e){0==e.data.code?(t.isshow=!1,t.$message.success("添加成功！"),setTimeout(function(){t.getMyOrder()},500)):t.$toast("error",5e3,e.data.msg),t.isSubmite=!1})},getMyOrder:function(){var t=this;t.loading=!0,t.$http({method:"get",url:"/admin/cms/resourcelist/mylist",params:{page:t.curPage,limit:12,title:t.title,status:t.status.join(","),startDate:""==t.startDate?null:t.startDate,endDate:""==t.endDate?null:t.endDate},headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(e){0==e.data.code&&(t.resourceList=e.data.page.records,t.total=e.data.page.total),t.loading=!1})},init:function(){this.getMyOrder()}},created:function(){this.init()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rt_cont"},[a("div",{staticStyle:{padding:"10px 0",background:"#F0F2F5"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/main/adminManageHome"}}},[t._v("首页")]),t._v(" "),a("el-breadcrumb-item",[t._v("内容发布管理")])],1)],1),t._v(" "),a("div",{staticClass:"nrgl"},[a("div",{staticClass:"btnhandle"},[a("h5",{staticClass:"pagett"},[t._v("资源申请管理")]),t._v(" "),a("el-button-group",{staticClass:"btbg"},[a("el-button",{staticClass:"updatebtn",attrs:{type:"primary",plain:""},on:{click:t.addNew}},[t._v("新建资源单")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.editeOrder}},[t._v("修改资源单")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.submitOrder}},[t._v("提交资源单")])],1),t._v(" "),a("loading-tip",{attrs:{"show-load":t.loading}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"table"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.resourceList,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"资源单编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"资源单名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.tbformat}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",formatter:t.updateTimeFormat}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticStyle:{color:"#409EFF"},on:{click:function(a){t.godtl(e.$index,e.row)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{staticClass:"page"},[a("div",{staticClass:"fr"},[a("el-pagination",{attrs:{background:"","current-page":t.curPage,"page-size":12,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.curPage=e}}})],1)]),t._v(" "),a("el-dialog",{attrs:{title:"新增资源单",visible:t.isshow,width:"30%"},on:{"update:visible":function(e){t.isshow=e}}},[a("div",{staticClass:"dialogcont"},[a("p",[t._v("资源单名称：")]),t._v(" "),a("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:t.newOrder.name,callback:function(e){t.$set(t.newOrder,"name",e)},expression:"newOrder.name"}}),t._v(" "),a("p",[t._v("资源单说明：")]),t._v(" "),a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:t.newOrder.abstracts,callback:function(e){t.$set(t.newOrder,"abstracts",e)},expression:"newOrder.abstracts"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("a",{staticClass:"aBtn",attrs:{disabled:t.isSubmite},on:{click:t.addNewOrder}},[t._v("确 定")]),t._v(" "),a("a",{staticClass:"aBtn aBtnCancle",on:{click:function(e){t.isshow=!1}}},[t._v("取 消")])])])],1),t._v(" "),a("div",{staticClass:"upldbtn"},[a("el-row",{staticClass:"btnrow fr"},[a("el-input",{staticStyle:{width:"280px"},attrs:{size:"mini",placeholder:"请输入资源单名称"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v(" "),a("el-date-picker",{staticClass:"inputsc",attrs:{size:"mini",type:"date",placeholder:"创建时间",format:"yyyy年MM月dd日","value-format":"yyyy-MM-dd"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("span",[t._v("至")]),t._v(" "),a("el-date-picker",{staticClass:"inputsc",attrs:{size:"mini",type:"date",placeholder:"创建时间",format:"yyyy年MM月dd日","value-format":"yyyy-MM-dd"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),a("a",{staticClass:"aBtn",on:{click:t.getMyOrder}},[t._v("搜索")]),t._v(" "),a("a",{staticClass:"aBtn aBtnCancle",on:{click:t.reset}},[t._v("重置")])],1)],1)],1)])])},staticRenderFns:[]};var l=a("VU/8")(s,n,!1,function(t){a("bpZX")},"data-v-3edb70a9",null);e.default=l.exports},bpZX:function(t,e){}});