webpackJsonp([37],{"68sd":function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("BO1k"),i=e.n(a),n=e("woOf"),o=e.n(n),l={name:"classicEditor",data:function(){return{loading:!1,treeList:[],defaultProps:{children:"childrenList",label:"name",isLeaf:"leaf"},parentClass:{},classify:{},isshow:!1,isEdite:!1,dropList:[],curClass:"",classId:"",treeData:"",showUpLoading:!1}},components:{loadingTip:e("T8Lg").a},methods:{addchild:function(){this.classify={},this.isshow=!0,this.isEdite=!1},append:function(s){this.classify={},this.parentClass=s,this.treeData=s,this.isshow=!0,this.isEdite=!1},remove:function(s,t){var e=s.parent,a=e.data.children||e.data,i=a.findIndex(function(s){return s.id===t.id});a.splice(i,1)},editeNode:function(s,t){this.classify=t,this.treeData=t,this.isshow=!0,this.isEdite=!0},deleteNode:function(s,t){var e=this,a=s.parent,i=a.data.childrenList||a.data,n=i.findIndex(function(s){return s.id===t.id});e.$http({method:"post",url:"/admin/cms/classify/delete",data:[t.id],headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){0==s.data.code&&(e.$message({message:"删除成功！",type:"success"}),i.splice(n,1))})},renderContent:function(s,t){var e=this,a=t.node,i=t.data;t.store;return s("span",{class:"custom-tree-node"},[s("span",[a.label]),s("span",[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return e.append(i)}}},["Append"]),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return e.remove(a,i)}}},["Delete"])])])},changeClassic:function(s){var t=s;t.children=[],this.curClass=t,this.parentClass=t,this.getTreeList(s.id)},addNode:function(s){var t=this;this.classify.name||t.$message({message:"中文名称必填！",type:"error"}),this.classify.code||t.$message({message:"编码必填！",type:"error"}),t.showUpLoading=!0,t.classify.classifyMappingId=t.parentClass.classifyMappingId,t.classify.parentId=t.parentClass.parentId==t.parentClass.classifyMappingId?0:t.parentClass.id,t.$http({method:"post",url:"/admin/cms/classify/save",data:t.classify,headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){0==s.data.code&&(t.isshow=!1,t.$message({message:"添加成功！",type:"success"}),t.showUpLoading=!1,t.getTreeList(t.classId))})},updateNode:function(){var s=this;s.showUpLoading=!0,s.$http({method:"post",url:"/admin/cms/classify/update",data:s.classify,headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){0==t.data.code&&(s.isshow=!1,s.$message({message:"修改成功！",type:"success"}),s.showUpLoading=!1,o()(s.treeData,s.classify))})},getDroplist:function(){var s=this;s.$http({method:"get",url:"/admin/cms/classifymapping/droplist",headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){s.dropList=t.data.list;var e=!0,a=!1,n=void 0;try{for(var o,l=i()(s.dropList);!(e=(o=l.next()).done);e=!0){var c=o.value;c.id==s.classId&&(s.curClass=c,s.curClass.children=[],s.parentClass=c,s.parentClass.parentId=c.classifyMappingId)}}catch(s){a=!0,n=s}finally{try{!e&&l.return&&l.return()}finally{if(a)throw n}}})},getTreeList:function(s){var t=this;t.loading=!0,t.$http({method:"get",url:"/admin/cms/classify/children",params:{classifyMappingId:s},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(s){t.loading=!1,t.treeList=s.data.classifyList})}},created:function(){this.classId=this.$route.query.id,this.getDroplist(),this.getTreeList(this.classId)}},c={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"rt_cont"},[e("div",{staticStyle:{padding:"15px 0",background:"#F0F2F5"}},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/main/adminManageHome"}}},[s._v("首页")]),s._v(" "),e("el-breadcrumb-item",[s._v("基础知识库")])],1)],1),s._v(" "),e("div",{staticClass:"nrgl"},[e("div",{staticClass:"btnhandle"},[e("h5",{staticClass:"pagett"},[s._v("分类法管理\n        "),e("el-dropdown",{staticStyle:{margin:"0 25px"},attrs:{trigger:"click"},on:{command:s.changeClassic}},[e("span",{staticClass:"el-dropdown-link",staticStyle:{cursor:"pointer"}},[s._v("\n            "+s._s(s.curClass.name)),e("i",{staticClass:"el-icon-caret-bottom"})]),s._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},s._l(s.dropList,function(t){return e("el-dropdown-item",{key:t.id,attrs:{command:t}},[s._v(s._s(t.name))])}))],1),s._v(" "),e("a",{staticClass:"aBtn",attrs:{icon:"el-icon-plus"},on:{click:s.addchild}},[s._v("+添加分类")])],1),s._v(" "),e("loading-tip",{attrs:{"show-load":s.loading}}),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.loading,expression:"!loading"}]},[e("el-tree",{ref:"tree",attrs:{data:s.treeList,"node-key":"id","default-expand-all":"","show-checkbox":"",props:s.defaultProps,"expand-on-click-node":!1},scopedSlots:s._u([{key:"default",fn:function(t){var a=t.node,i=t.data;return e("span",{staticClass:"custom-tree-node"},[e("span",[s._v(s._s(a.label)+s._s(a.classType))]),s._v(" "),e("span",{staticStyle:{"margin-left":"30px"}},[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return s.append(i)}}},[e("i",{staticClass:"el-icon-plus"}),s._v(" 新增下级分类\n                  ")]),s._v(" "),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return s.editeNode(a,i)}}},[e("i",{staticClass:"el-icon-edit"}),s._v(" 编辑\n                  ")]),s._v(" "),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return s.deleteNode(a,i)}}},[e("i",{staticClass:"el-icon-delete"}),s._v(" 删除\n                  ")])],1)])}}])})],1),s._v(" "),e("el-dialog",{attrs:{title:s.curClass.name,visible:s.isshow,width:"30%"},on:{"update:visible":function(t){s.isshow=t}}},[e("div",{staticClass:"dialogcont"},[e("p",[e("span",{staticStyle:{color:"red"}},[s._v("*")]),s._v(" 中文名称：")]),s._v(" "),e("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:s.classify.name,callback:function(t){s.$set(s.classify,"name",t)},expression:"classify.name"}}),s._v(" "),e("p",[s._v("英文名称：")]),s._v(" "),e("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:s.classify.englishName,callback:function(t){s.$set(s.classify,"englishName",t)},expression:"classify.englishName"}}),s._v(" "),e("p",[s._v("其它名称：")]),s._v(" "),e("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:s.classify.otherName,callback:function(t){s.$set(s.classify,"otherName",t)},expression:"classify.otherName"}}),s._v(" "),e("p",[e("span",{staticStyle:{color:"red"}},[s._v("*")]),s._v(" 编码：")]),s._v(" "),e("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:s.classify.code,callback:function(t){s.$set(s.classify,"code",t)},expression:"classify.code"}}),s._v(" "),e("p",[s._v("备注：")]),s._v(" "),e("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:3},placeholder:"请输入内容"},model:{value:s.classify.propString,callback:function(t){s.$set(s.classify,"propString",t)},expression:"classify.propString"}})],1),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.isEdite,expression:"!isEdite"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("a",{staticClass:"aBtn aBtnCancle",on:{click:function(t){s.isshow=!1}}},[s._v("取 消")]),s._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:!s.showUpLoading,expression:"!showUpLoading"}],staticClass:"aBtn",on:{click:function(t){s.addNode()}}},[s._v(" 确 定")]),s._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:s.showUpLoading,expression:"showUpLoading"}],staticClass:"aBtn"},[e("i",{staticClass:"el-icon-loading"}),s._v(" 确 定")])]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:s.isEdite,expression:"isEdite"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("a",{staticClass:"aBtn aBtnCancle",on:{click:function(t){s.isshow=!1}}},[s._v("取 消")]),s._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:!s.showUpLoading,expression:"!showUpLoading"}],staticClass:"aBtn",on:{click:function(t){s.updateNode()}}},[s._v("确 定")]),s._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:s.showUpLoading,expression:"showUpLoading"}],staticClass:"aBtn"},[e("i",{staticClass:"el-icon-loading"}),s._v("确 定")])])])],1)])])},staticRenderFns:[]};var r=e("VU/8")(l,c,!1,function(s){e("peIN")},"data-v-6fe36846",null);t.default=r.exports},peIN:function(s,t){}});